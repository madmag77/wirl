workflow NewsDigestWorkflow {

  metadata {
    description: "Collect recent news, summarize, and deliver the digest"
    owner: "assistant"
    version: "1.0"
  }

  inputs {
    String trigger
  }

  outputs {
    String summary = SummarizeNews.summary
  }

  node GetResources {
    call get_resources
    inputs {
      String trigger = trigger
    }
    outputs {
      List<T<NewsResource>> resources
    }
  }

  node FetchNews {
    call fetch_news
    inputs {
      List<T<NewsResource>> resources = GetResources.resources
    }
    const {
      days_back: 1
      model: "qwen3:8b"
      reasoning: True
      temperature: 0
    }
    outputs {
      List<T<NewsItem>> news_items
    }
  }

  node SummarizeNews {
    call summarize_news
    inputs {
      List<T<NewsItem>> news_items = FetchNews.news_items
    }
    const {
      model: "gpt-oss:20b"
      reasoning: False
      temperature: 0
    }
    outputs {
      String summary
    }
  }

  node SendSummary {
    call send_summary
    inputs {
      String summary = SummarizeNews.summary
    }
    const {
      type: "telegram"
    }
    outputs {
      Bool success
    }
  }
}
